% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sc_markerHeatmap.R
\name{sc_markerHeatmap}
\alias{sc_markerHeatmap}
\title{Plot and Cluster Top Marker Genes as a Heatmap from Single-Cell Transcriptome Data}
\usage{
sc_markerHeatmap(
  dat,
  topN = 3,
  selection = character(),
  cluster.var = "cluster",
  perc.cutoff = 10,
  perc.diff.cutoff = 20,
  order.var = "perc.diff",
  padj.wilcox.cutoff = 0.05,
  logFC.cutoff = 0.25,
  padj.fisher.cutoff = NULL,
  log2OR.cutoff = NULL,
  auc.cutoff = NULL,
  alternative = "greater",
  cluster.rows = TRUE,
  cutree.rows = NULL,
  order.cols = FALSE,
  show.col.clusters = TRUE,
  scale = FALSE,
  pdf.file = NULL
)
}
\arguments{
\item{dat}{A data.table containing marker gene statistics (see ?sc_computeMarkerGenes).}

\item{topN}{Number of top genes to select per cluster (default: Inf, i.e., all). If set to 0 or NULL, only the genes listed
in selection (next argument) will be used.}

\item{selection}{Character vector of gene symbols to highlight or force-include in the heatmap (default: character()).}

\item{perc.cutoff}{Minimum percentage of expressing cells within the cluster (default: 10).}

\item{perc.diff.cutoff}{Minimum difference in percentage of expressing cells within vs. outside the cluster (default: 20).}

\item{order.var}{Variable to order genes by; one of "perc.diff", "auc", "logFC", or "log2OR" (default: "perc.diff").}

\item{padj.wilcox.cutoff}{Adjusted Wilcoxon p-value cutoff (default: 0.05).}

\item{logFC.cutoff}{Log fold change cutoff (default: 0).}

\item{padj.fisher.cutoff}{Adjusted Fisher p-value cutoff (default: 1).}

\item{log2OR.cutoff}{Log2 odds ratio cutoff (default: 1).}

\item{auc.cutoff}{AUC cutoff (default: 0.5).}

\item{alternative}{"greater" for upregulated markers, "smaller" for downregulated (default: "greater").}

\item{cluster.rows}{Logical; whether to cluster heatmap rows (default: TRUE).}

\item{cutree.rows}{Number of row clusters to cut the dendrogram into (default: 10).}

\item{order.cols}{Logical; whether to order columns by cluster and rank (default: FALSE).}

\item{show.col.clusters}{Should column cluster names be shown? Default= TRUE.}

\item{scale}{Should the % of expressing cells matrix be scaled before plotting? Default= FALSE.}

\item{pdf.file}{If specified, the heatmap will be saved in a pdf with an optimized layout. Default= NULL.}
}
\value{
Invisibly returns a list containing the heatmap matrix and the table of top marker genes.
}
\description{
Selects top marker genes per cluster based on multiple statistical cutoffs, then visualizes their expression as a heatmap.
Optionally clusters rows and/or orders columns, and allows highlighting of selected genes.
}
