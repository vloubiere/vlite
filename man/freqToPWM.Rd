% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/freqToPWM.R
\name{freqToPWM}
\alias{freqToPWM}
\title{Frequency matrix to PWM}
\usage{
freqToPWM(
  matrix,
  pseudocount = 0.00001,
  bg = c(A = 0.25, C = 0.25, G = 0.25, T = 0.25)
)
}
\arguments{
\item{matrix}{A PPM or a PFM that will be converted to PFM before computing the output PWM.}

\item{pseudocount}{Pseudocount to be added to the PFM columns before logging. Default= 1e-5.}

\item{bg}{Background probabilities. Default= c("A"= .25, "C"= .25, "G"= .25, "T"= .25).}
}
\value{
Returns a PWM.
}
\description{
Matrices used to represent DNA binding motifs commonly come in four flavors:
}
\details{
- PFM (Position Frequency Matrix): Raw counts of each nucleotide at each position.

- PPM (Position Probability Matrix): Column-normalized version of the PFM where
  counts are converted to probabilities (each column sums to 1).

- PWM/PSSM (Position Weight/Specific Scoring Matrix): Log-odds scores that compare
  the PPM to a background model. Typically: log2(observed_probability / background_probability).
  These matrices are used for scoring sequences and calling motif hits.

- ICM (Information Content Matrix): Visualization-oriented transformation derived
  from the PPM using Shannon information. For DNA, the per-position information
  content is I = 2 - H, where H is the column entropy in bits; base heights in
  sequence logos are p_base * I. The maximum per-position information is 2 bits.
}
\examples{
PPM <- matrix(
  c(
    0.33,0.21,0.33,0.13,0.1,0.42,0.38,0.1,0.26,0.26,0.27,0.21,0,0.03,
    0.19,0.78,0.1,0.05,0.1,0.75,0.24,0.05,0.18,0.53,0.8,0.04,0,0.16,
    0.13,0.16,0.02,0.69,0.04,0.05,0.7,0.21,0.24,0.09,0.57,0.1,0.02,0.8,
    0.15,0.03,0.22,0.28,0.31,0.19,0.35,0.26,0.26,0.13,0.19,0.33,0.26,0.22
  ), nrow= 4
)
PWM <- freqToPWM(PPM)

}
