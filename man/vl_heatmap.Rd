% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vl_heatmap.R
\name{vl_heatmap}
\alias{vl_heatmap}
\title{Create Enhanced Heatmap Visualization}
\usage{
vl_heatmap(
  x,
  cluster.rows = FALSE,
  cluster.cols = FALSE,
  kmeans.k = NA,
  zlim = NULL,
  breaks = NULL,
  col = NULL,
  show.rownames = TRUE,
  show.colnames = TRUE,
  tilt.colnames = TRUE,
  clustering.method = "complete",
  clustering.distance.rows = "euclidean",
  clustering.distance.cols = "euclidean",
  cutree.rows,
  cutree.cols,
  show.row.clusters = "right",
  show.col.clusters = "top",
  row.clusters.col = c("grey90", "grey40"),
  col.clusters.col = c("grey90", "grey40"),
  legend.cex = 1,
  legend.title = "Value",
  show.numbers = FALSE,
  numbers.cex = 0.7,
  cluster.seed = 3453
)
}
\arguments{
\item{x}{Numeric matrix to be displayed as heatmap.}

\item{cluster.rows}{Logical or vector specifying row clustering:
* FALSE: no clustering (default)
* TRUE: perform clustering
* vector: pre-defined clustering}

\item{cluster.cols}{Similar to cluster.rows but for columns.}

\item{kmeans.k}{Integer specifying number of k-means clusters. NA (default)
uses hierarchical clustering instead.}

\item{zlim}{Numeric vector of length 2 specifying the minimum and maximum values
for color mapping (e.g., c(-1, 1)). If NULL (default), limits are automatically
calculated based on data range. Note: this argument is ignored if breaks are
specified directly.}

\item{breaks}{Numeric vector of break points for color mapping. Takes precedence
over `zlim` if both are specified. If NULL (default), breaks are automatically
calculated either from `zlim` if provided, or from the data range. Break points
define the boundaries between colors, so if using n colors, breaks should be a
vector of length n+1.}

\item{col}{Color palette for the heatmap. If NULL (default), automatically
selects between a diverging blue-white-red palette for data centered around
zero, or a sequential blue-yellow palette for non-negative data.}

\item{show.rownames}{Logical; whether to show row names (TRUE by default).}

\item{show.colnames}{Logical; whether to show column names (TRUE by default).}

\item{tilt.colnames}{Logical; whether to tilt column names (TRUE by default).}

\item{clustering.method}{Character string specifying hierarchical clustering
method ("complete" by default).}

\item{clustering.distance.rows}{Character string specifying distance metric
for rows ("euclidean" by default).}

\item{clustering.distance.cols}{Similar to clustering.distance.rows but for
columns.}

\item{cutree.rows}{Integer specifying number of row clusters to cut tree into.}

\item{cutree.cols}{Similar to cutree.rows but for columns.}

\item{show.row.clusters}{Character specifying position of row cluster
visualization: "right", "left", or FALSE.}

\item{show.col.clusters}{Character specifying position of column cluster
visualization: "top", "bottom", or FALSE.}

\item{row.clusters.col}{Vector of two colors for row cluster gradient.}

\item{col.clusters.col}{Vector of two colors for column cluster gradient.}

\item{legend.cex}{Numeric scaling factor for legend (1 by default).}

\item{legend.title}{Character string for legend title ("Value" by default).}

\item{show.numbers}{Logical or matrix; if TRUE or matrix provided, displays
values in cells.}

\item{numbers.cex}{Numeric scaling factor for displayed numbers (0.7 by
default).}

\item{cluster.seed}{Integer seed for reproducible clustering (3453 by
default).}
}
\value{
Invisibly returns a list with two data.tables:
* row: contains row names, ordering, and clustering (if applicable)
* col: contains column names, ordering, and clustering (if applicable)
}
\description{
Creates a highly customizable heatmap using base R graphics, with support
for hierarchical clustering, k-means clustering, dendrograms, and cluster
visualization. This function provides a comprehensive solution for
visualizing matrix data with advanced clustering options.
}
\details{
The function provides multiple clustering options:
* Hierarchical clustering with various distance metrics
* K-means clustering
* Pre-defined clustering
* Separate clustering for rows and columns

Color schemes are automatically selected based on data characteristics:
* For data spanning positive and negative: blue-white-red
* For non-negative data: blue-yellow

Cluster visualization options include:
* Dendrograms
* Color-coded cluster bars
* Cluster labels with sizes
}
\examples{
# Create example matrix
set.seed(1234)
test <- matrix(rnorm(200), 20, 10)
test[1:10, seq(1, 10, 2)] <- test[1:10, seq(1, 10, 2)] + 3
test[11:20, seq(2, 10, 2)] <- test[11:20, seq(2, 10, 2)] + 2
test[15:20, seq(2, 10, 2)] <- test[15:20, seq(2, 10, 2)] + 4
colnames(test) <- paste("Test", 1:10, sep = "")
rownames(test) <- paste("Gene", 1:20, sep = "")


# Basic heatmap
gPar(mfrow= c(2,2))
vl_heatmap(test)
title(main= "No clustering")

# With hierarchical ordering
vl_heatmap(test,
         cluster.rows= TRUE,
         cluster.cols= TRUE,
         zlim= c(-5, 5))
title(main= "hclust rows & cols")
vl_heatmap(test,
         cluster.rows= TRUE,
         cluster.cols= TRUE,
         cutree.rows = 3,
         cutree.cols = 3,
         show.numbers = round(test, 1))
title(main= "Cut hclust rows & cols")

# Save clusters!
cl <- vl_heatmap(test2,
               cluster.rows= TRUE,
               kmeans.k= 5,
               cluster.cols= TRUE,
               show.row.clusters = "left",
               show.col.clusters = "bottom")
title(main= "Kmeans rows, hclust cols")

# Look at clusters
print(cl)

}
\seealso{
\code{\link{vl_image}} for the underlying image plotting
\code{\link{heatkey}} for the color key
\code{\link{hclust}} for hierarchical clustering
\code{\link{kmeans}} for k-means clustering
}
