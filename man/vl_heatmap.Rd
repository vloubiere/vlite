% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vl_heatmap.R
\name{vl_heatmap}
\alias{vl_heatmap}
\title{Create Enhanced Heatmap Visualization}
\usage{
vl_heatmap(
  x,
  cluster.rows = TRUE,
  cluster.cols = FALSE,
  kmeans.k = NA,
  breaks = NULL,
  col = NULL,
  show.rownames = TRUE,
  show.colnames = TRUE,
  tilt.colnames = TRUE,
  main = NA,
  clustering.method = "complete",
  clustering.distance.rows = "euclidean",
  clustering.distance.cols = "euclidean",
  cutree.rows,
  cutree.cols,
  show.row.clusters = "right",
  show.col.clusters = "top",
  row.clusters.col = c("grey90", "grey40"),
  col.clusters.col = c("grey90", "grey40"),
  legend.cex = 1,
  legend.title = "Value",
  show.numbers = FALSE,
  numbers.cex = 0.7,
  cluster.seed = 3453,
  useRaster = FALSE
)
}
\arguments{
\item{x}{A numeric matrix to be displayed as a heatmap.}

\item{cluster.rows}{Logical or vector specifying row clustering:
* `TRUE`: perform clustering (default)
* `FALSE`: no clustering
* vector: pre-defined clustering}

\item{cluster.cols}{Similar to `cluster.rows` but for columns. Default= FALSE.}

\item{kmeans.k}{Integer specifying the number of k-means clusters. Defaults to `NA` (uses hierarchical clustering).}

\item{breaks}{A numeric vector specifying the breakpoints for color mapping.
Defaults to 21 evenly spaced breaks spanning the range of `x`.}

\item{col}{A vector of colors corresponding to the values in `breaks`. If `NULL`,
a diverging blue-white-red palette is used for data spanning positive and negative values,
or a sequential blue-yellow palette.}

\item{show.rownames}{Logical; whether to display row names. Default is `TRUE`.}

\item{show.colnames}{Logical; whether to display column names. Default is `TRUE`.}

\item{tilt.colnames}{Logical; whether to tilt column names for better readability. Default is `TRUE`.}

\item{main}{Ad title for the heatmap. Default= NA.}

\item{clustering.method}{Character string specifying the hierarchical clustering method. Default is `"complete"`.}

\item{clustering.distance.rows}{Character string specifying the distance metric for rows. Default is `"euclidean"`.}

\item{clustering.distance.cols}{Similar to `clustering.distance.rows` but for columns.}

\item{cutree.rows}{Integer specifying the number of row clusters to cut the tree into.}

\item{cutree.cols}{Similar to `cutree.rows` but for columns.}

\item{show.row.clusters}{Character specifying the position of row cluster visualization: `"right"`, `"left"`, or `FALSE`.}

\item{show.col.clusters}{Character specifying the position of column cluster visualization: `"top"`, `"bottom"`, or `FALSE`.}

\item{row.clusters.col}{A vector of two colors for the row cluster gradient. Default is `c("grey90", "grey40")`.}

\item{col.clusters.col}{A vector of two colors for the column cluster gradient. Default is `c("grey90", "grey40")`.}

\item{legend.cex}{Numeric scaling factor for the legend. Default is `1`.}

\item{legend.title}{Character string for the legend title. Default is `"Value"`.}

\item{show.numbers}{Logical or matrix; if `TRUE` or a matrix is provided, displays values in cells.}

\item{numbers.cex}{Numeric scaling factor for the size of displayed numbers. Default is `0.7`.}

\item{cluster.seed}{Integer seed for reproducible clustering. Default is `3453`.}

\item{useRaster}{logical; if TRUE a bitmap raster is used to plot the image instead of polygons. Default= FALSE.}
}
\value{
Invisibly returns a list with two `data.table` objects:
* `row`: Contains row names, ordering, and clustering (if applicable).
* `col`: Contains column names, ordering, and clustering (if applicable).
}
\description{
Generates a customizable heatmap with support for hierarchical clustering, k-means clustering,
dendrograms, and cluster visualization. This function provides advanced options for visualizing
matrix data with clustering and color-coded annotations.
}
\details{
The function supports:
- Hierarchical clustering with customizable distance metrics and methods.
- K-means clustering for rows or columns.
- Pre-defined clustering for rows or columns.
- Visualization of dendrograms and color-coded cluster bars.

Color schemes are automatically selected based on the data:
- For data spanning positive and negative values: blue-white-red.
- For non-negative data: blue-yellow.

The default behavior for `breaks` is to create 21 evenly spaced intervals spanning the range of `x`.
If `x` contains both positive and negative values, the range is symmetrically extended around zero.
}
\examples{
# Create example matrix
set.seed(1234)
mat <- matrix(rnorm(200), 20, 10)
colnames(mat) <- paste("Sample", 1:10, sep = "")
rownames(mat) <- paste("Gene", 1:20, sep = "")

# Basic heatmap
vl_par()
vl_heatmap(mat)

# Hierarchical clustering
vl_heatmap(mat, cluster.rows = TRUE, cluster.cols = TRUE)

# K-means clustering
vl_heatmap(mat, kmeans.k = 3, cluster.cols = TRUE)

# Display cell values
vl_heatmap(mat, show.numbers = round(mat, 1))

}
\seealso{
\code{\link{vl_image}} for the underlying image plotting.
\code{\link{hclust}} for hierarchical clustering.
\code{\link{kmeans}} for k-means clustering.
}
