% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vl_heatmap.R
\name{vl_heatmap}
\alias{vl_heatmap}
\title{Create Enhanced Heatmap Visualization}
\usage{
vl_heatmap(
  x,
  cluster.rows = TRUE,
  cluster.cols = FALSE,
  kmeans.k = NA,
  breaks = NULL,
  col = NULL,
  row.annotations = NULL,
  col.annotations = NULL,
  show.legend = "right",
  legend.title = "Value",
  row.annotations.title = "Rows",
  col.annotations.title = "Columns",
  show.numbers = FALSE,
  show.rownames = TRUE,
  show.colnames = TRUE,
  main = NA,
  useRaster = FALSE,
  clustering.distance.rows = "euclidean",
  clustering.distance.cols = "euclidean",
  clustering.method = "complete",
  cutree.rows,
  cutree.cols,
  show.row.clusters = "right",
  show.col.clusters = "top",
  show.row.dendro = TRUE,
  show.col.dendro = TRUE,
  gap.width = 1/80,
  cluster.seed = 3453,
  row.clusters.col = c("grey90", "grey40"),
  col.clusters.col = c("grey90", "grey40"),
  row.annotations.col = rainbow(9)[1:7],
  col.annotations.col = rainbow(9)[1:7],
  na.col = "lightgrey",
  legend.cex = 1,
  numbers.cex = 0.7
)
}
\arguments{
\item{x}{A matrix, data.table or data.frame of numeric values or factors (that will be coerced to numeric) to be displayed as a heatmap.}

\item{cluster.rows}{Logical or vector specifying row clustering:
* TRUE: perform clustering (default)
* FALSE: no clustering
* vector: pre-defined clustering}

\item{cluster.cols}{Similar to cluster.rows but for columns. Default= FALSE.}

\item{kmeans.k}{Integer specifying the number of k-means clusters. Defaults= NA (uses hierarchical clustering).}

\item{breaks}{A numeric vector specifying the breakpoints for color mapping.
Can either be the length of col (centered breaks) or one element longer (breaks as edges).
If set to NULL, defaults to the different levels for factors (centered breaks), a diverging vector
of 21 values (centered on 0) or to 20 values spanning the range of x (breaks as edges).}

\item{col}{A vector of colors corresponding to the values in breaks.
Can either be the length of breaks (centered breaks) or one element shorter (breaks as edges).
If set to NULL, rainbow colors are used for factors, a diverging blue-white-red palette for data
spanning positive and negative values, or a sequential blue-yellow palette for data with a unique sign.}

\item{row.annotations}{A vector of length nrow(x) containing row annotations.}

\item{col.annotations}{A vector of length ncol(x) containing row annotations.}

\item{show.legend}{Should the legend be plotted?
Possible values are TRUE, FALSE, "right" (similar to TRUE) or "top". Default= "right".}

\item{legend.title}{Character string for the legend title. Default= "Value".}

\item{row.annotations.title}{Title for the row annotations legend. Default= "Rows".}

\item{col.annotations.title}{Title for the column annotations legend. Default= "Columns".}

\item{show.numbers}{Logical or matrix; if set to TRUE or a matrix is provided, displays values in cells.}

\item{show.rownames}{Logical; whether to display row names. Default= TRUE.}

\item{show.colnames}{Logical; whether to display column names. Default= TRUE.}

\item{main}{Add title to the heatmap. Default= NA.}

\item{useRaster}{logical; if TRUE a bitmap raster is used to plot the image instead of polygons. Default= FALSE.}

\item{clustering.distance.rows}{Character string specifying the distance metric for rows. Default is "euclidean".}

\item{clustering.distance.cols}{Similar to clustering.distance.rows but for columns.}

\item{clustering.method}{Character string specifying the hierarchical clustering method. Default is "complete".}

\item{cutree.rows}{Integer specifying the number of row clusters to cut the tree into.}

\item{cutree.cols}{Similar to cutree.rows but for columns.}

\item{show.row.clusters}{Character specifying the position of row cluster visualization: "right", "left", or FALSE.}

\item{show.col.clusters}{Character specifying the position of column cluster visualization: "top", "bottom", or FALSE.}

\item{show.row.dendro}{If rows are clustered using hclust, should the dendrogram be shown? Default= TRUE.}

\item{show.col.dendro}{If cols are clustered using hclust, should the dendrogram be shown? Default= TRUE.}

\item{gap.width}{The width of the gap between clusters, expressed as a fraction of the plot limits. Default= 1/80.}

\item{cluster.seed}{Integer seed for reproducible clustering. Default= 3453.}

\item{row.clusters.col}{A vector of two colors for the row cluster gradient. Default is c("grey90", "grey40").}

\item{col.clusters.col}{A vector of two colors for the column cluster gradient. Default is c("grey90", "grey40").}

\item{row.annotations.col}{Row annotations colors. Default= rainbow(9)[1:7].}

\item{col.annotations.col}{Col annotations colors. Default= rainbow(9)[1:7].}

\item{na.col}{Color for NA values. Default= "ligthgrey".}

\item{legend.cex}{Numeric scaling factor for the legend. Default= 1.}

\item{numbers.cex}{Numeric scaling factor for the size of displayed numbers. Default= 0.7.}
}
\value{
Invisibly returns a list with two `data.table` objects:
* row: Contains row names, ordering, and clustering (if applicable).
* col: Contains column names, ordering, and clustering (if applicable).
}
\description{
Generates a customizable heatmap with support for hierarchical clustering, k-means clustering,
dendrograms, and cluster visualization. This function provides advanced options for visualizing
matrix data with clustering and color-coded annotations.
}
\details{
The function supports:
- Hierarchical clustering with customizable distance metrics and methods.
- K-means clustering for rows or columns.
- Pre-defined clustering for rows or columns.
- Visualization of dendrograms and color-coded cluster bars.

Color schemes are automatically selected based on the data:
- For data spanning positive and negative values: blue-white-red.
- For non-negative data: blue-yellow.

The default behavior for `breaks` is to create 21 evenly spaced intervals spanning the range of `x`.
If `x` contains both positive and negative values, the range is symmetrically extended around zero.
}
\examples{
# Create example matrix
set.seed(1234)
mat <- matrix(rnorm(200), 20, 10)
colnames(mat) <- paste("Sample", 1:10, sep = "")
rownames(mat) <- paste("Gene", 1:20, sep = "")

# Basic heatmap
vl_par()
vl_heatmap(mat)

# Hierarchical clustering
vl_heatmap(mat, cluster.rows = TRUE, cluster.cols = TRUE)

# K-means clustering
vl_heatmap(mat, kmeans.k = 3, cluster.cols = TRUE)

# Display cell values
vl_heatmap(mat, show.numbers = round(mat, 1))

}
\seealso{
\code{\link{vl_image}} for the underlying image plotting.
\code{\link{hclust}} for hierarchical clustering.
\code{\link{kmeans}} for k-means clustering.
}
