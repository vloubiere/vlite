% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pwmToICM.R
\name{pwmToICM}
\alias{pwmToICM}
\title{PWM to ICM (Information Content Matrix)}
\usage{
pwmToICM(PWM, bg = c(A = 0.25, C = 0.25, G = 0.25, T = 0.25))
}
\arguments{
\item{bg}{Background probabilities named c("A","C","G","T"). Default = uniform 0.25.}

\item{pwm}{A numeric 4 x L matrix of log2-odds scores (PWM), rows named "A","C","G","T".}
}
\value{
A 4 x L ICM matrix (rows A,C,G,T), in bits.
}
\description{
Converts a DNA PWM (log2-odds vs background) into an Information Content Matrix (ICM).
Steps:
  1) Convert PWM to PPM using p_ij ‚àù bg_i * 2^{PWM_ij}, normalized per column.
  2) Compute per-position information I_j = 2 - H_j (bits), where
     H_j = -sum_i p_ij * log2(p_ij).
  3) Return ICM with entries p_ij * I_j.
}
\examples{
# Example: start from a PPM and create a PWM, then convert to ICM
PPM <- matrix(
  c(
    0.33,0.21,0.33,0.13,0.1,0.42,0.38,0.1,0.26,0.26,0.27,0.21,0,0.03,
    0.19,0.78,0.1,0.05,0.1,0.75,0.24,0.05,0.18,0.53,0.8,0.04,0,0.16,
    0.13,0.16,0.02,0.69,0.04,0.05,0.7,0.21,0.24,0.09,0.57,0.1,0.02,0.8,
    0.15,0.03,0.22,0.28,0.31,0.19,0.35,0.26,0.26,0.13,0.19,0.33,0.26,0.22
  ), nrow= 4
)
PWM <- pfmToPWM(PPM)

# convert to ICM
ICM <- pwmToICM(PWM)
}
