% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cmd_DESeq2_PROseq.R
\name{vl_PROseq_DESeq2}
\alias{vl_PROseq_DESeq2}
\title{Generate Commands for DESeq2 Analysis of PRO-seq Data}
\usage{
vl_PROseq_DESeq2(
  umi.count.tables,
  sample.names,
  conditions,
  ctl.conditions = unique(conditions),
  ref.genome.stat.files,
  spikein.stat.files,
  normalization = "spikeIn",
  output.prefix,
  feature,
  dds.output.folder = "db/dds/PROseq/",
  FC.tables.output.folder = "db/FC_tables/PROseq/",
  MAplots.output.folder = "pdf/MAplots/PROseq/",
  Rpath = "/software/f2022/software/r/4.3.0-foss-2022b/bin/Rscript"
)
}
\arguments{
\item{umi.count.tables}{A character vector of paths to UMI count files in `.txt` format.}

\item{sample.names}{A character vector of sample names corresponding to the UMI count files.}

\item{conditions}{A character vector of experimental conditions for each sample.}

\item{ctl.conditions}{A character vector of control conditions. Default: all unique values in `conditions`.}

\item{ref.genome.stat.files}{A character vector of paths to reference genome statistics files in `.txt` format.}

\item{spikein.stat.files}{A character vector of paths to spike-in statistics files in `.txt` format.}

\item{normalization}{A character string specifying the normalization method. Options are `default`, `libsize`, or `spikeIn`.
Default: `spikeIn`.}

\item{output.prefix}{A character string specifying the prefix for output files.}

\item{feature}{A character string specifying the genomic feature being analyzed (e.g., `"exons"`, `"genes"`).}

\item{dds.output.folder}{Directory for the DESeq2 object output. Default: `db/dds/PROseq/`.}

\item{FC.tables.output.folder}{Directory for the fold-change tables. Default: `db/FC_tables/PROseq/`.}

\item{MAplots.output.folder}{Directory for the MA plots. Default: `pdf/MAplots/PROseq/`.}

\item{Rpath}{Path to the Rscript binary. Default: `/software/f2022/software/r/4.3.0-foss-2022b/bin/Rscript`.}
}
\value{
A `data.table` with the following columns:
- `file.type`: Labels for the output files (`DESeq2.dds`, `FC.table`, `MA.plot`).
- `path`: Paths to the output files.
- `cmd`: Shell command to run the DESeq2 analysis pipeline.
}
\description{
This function generates shell commands to perform differential expression analysis of PRO-seq data using DESeq2.
It supports various normalization methods, including spike-in normalization, and outputs DESeq2 objects, fold-change tables, and MA plots.
}
\examples{
# Example usage
cmd <- vl_PROseq_DESeq2(
  umi.count.tables = c("sample1_counts.txt", "sample2_counts.txt"),
  sample.names = c("sample1", "sample2"),
  conditions = c("treated", "control"),
  ctl.conditions = "control",
  ref.genome.stat.files = c("sample1_ref_genome_stats.txt", "sample2_ref_genome_stats.txt"),
  spikein.stat.files = c("sample1_spikein_genome_stats.txt", "sample2_spikein_genome_stats.txt"),
  normalization = "spikeIn",
  output.prefix = "experiment1",
  feature = "transcripts"
)
print(cmd)

}
