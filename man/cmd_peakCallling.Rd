% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cmd_peakCalling.R
\name{cmd_peakCallling}
\alias{cmd_peakCallling}
\title{Generate Commands for Peak Calling Using MACS2}
\usage{
cmd_peakCallling(
  bam,
  bam.input = NULL,
  layout,
  output.prefix,
  keep.dup = 1,
  extsize = 200,
  shift = 0,
  genome.macs2,
  peaks.output.folder = "db/peaks/",
  broad = FALSE
)
}
\arguments{
\item{bam}{character. Vector of paths to BAM files for peak calling.}

\item{bam.input}{character. Optional vector of paths to input/control BAM files.
Must match the order of treatment BAM files. Default: NULL.}

\item{layout}{character(1). Sequencing layout, must be either "PAIRED" or "SINGLE".}

\item{output.prefix}{character(1). Prefix for output files.}

\item{extsize}{numeric(1). Read extension size for MACS2. Default: 300.}

\item{genome.macs2}{character(1). Genome size parameter for MACS2 (e.g., "mm" or "hs").}

\item{peaks.output.folder}{character(1). Directory where peak files will be written.}

\item{broad}{logical(1). Whether to call broad peaks. Default: FALSE.}

\item{Rpath}{character(1). Path to Rscript executable.
Default: "/software/f2022/software/r/4.3.0-foss-2022b/bin/Rscript"}

\item{genome.bw}{character(1). Genome sizes file for bigWig conversion.}

\item{bw_output_folder}{character(1). Directory where bigWig files will be written.}
}
\value{
A data.table with three columns:
\describe{
  \item{file.type}{Labels for output files ("peaks", "bw", "peaks.merge", "bw.merge", "conf.peaks")}
  \item{path}{Full paths to the output files}
  \item{cmd}{Shell command to run the peak calling pipeline}
}
}
\description{
Generates shell commands to perform peak calling on BAM files using MACS2,
converts bedGraph to bigWig format, and identifies confident peaks across replicates.
The function handles both single-sample and merged peak calling, with optional input controls.
}
\details{
The function generates a pipeline that:
\enumerate{
  \item Calls peaks for individual replicates using MACS2
  \item Calls peaks on merged BAM files
  \item Converts MACS2 bedGraph output to bigWig format
  \item Identifies confident peaks across replicates
}
}
\section{Output Files}{

The function generates several types of files:
\itemize{
  \item Individual replicate peaks: <prefix>_<replicate>_peaks.narrowPeak
  \item Individual replicate signal: <prefix>_<replicate>.bw
  \item Merged peaks: <prefix>_merge_peaks.narrowPeak
  \item Merged signal: <prefix>_merge.bw
  \item Confident peaks: <prefix>_confident_peaks.narrowPeak
}
}

\section{Requirements}{

\itemize{
  \item MACS2 must be installed and available in the system PATH
  \item R with required packages (genomicsPipelines) must be installed
  \item Output directories must exist and be writable
}
}

\examples{
\dontrun{
# Basic peak calling without input controls
cmd_peakCallling(
  bam = c("/data/bam/rep1.bam", "/data/bam/rep2.bam"),
  replicate = c("rep1", "rep2"),
  layout = "PAIRED",
  genome.macs2 = "mm",
  output.prefix = "sample1",
  peaks.output.folder = "/data/peaks/",
  genome.bw = "/data/genome/mm10.chrom.sizes",
  bw_output_folder = "/data/bigwig/"
)

# Peak calling with input controls
cmd_peakCallling(
  bam = c("/data/bam/rep1.bam", "/data/bam/rep2.bam"),
  replicate = c("rep1", "rep2"),
  bam.input = c("/data/bam/input1.bam", "/data/bam/input2.bam"),
  layout = "PAIRED",
  genome.macs2 = "mm",
  output.prefix = "sample1",
  peaks.output.folder = "/data/peaks/",
  genome.bw = "/data/genome/mm10.chrom.sizes",
  bw_output_folder = "/data/bigwig/"
)
}

}
\seealso{
\itemize{
  \item MACS2 documentation: \url{https://github.com/macs3-project/MACS}
}
}
